"use strict";(()=>{var e={};e.id=2026,e.ids=[2026],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},69766:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>x,originalPathname:()=>g,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>k,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>f});var o={};t.r(o),t.d(o,{GET:()=>c});var s=t(95419),i=t(69108),a=t(99678),n=t(98984),u=t(86323);async function c(e){let r=e.nextUrl.searchParams.get("token");if(!r)return new n.NextResponse("Missing token parameter",{status:400});let t=(0,u.eI)("https://rfexljxsabsbfbszzvjf.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);try{let{data:e,error:o}=await t.from("sent_emails").select("id, review_link").eq("token",r).single();if(o||!e)return console.error("Error finding email with token:",o||"No data found"),new n.NextResponse("Invalid token or link expired",{status:400});let s=new Date().toISOString(),{error:i}=await t.from("sent_emails").update({clicked_at:s}).eq("token",r);if(i)return console.error("Error updating clicked_at timestamp:",i),new n.NextResponse("Error processing your request",{status:500});console.log(`Click tracked for token: ${r} at ${s}`);let a=e.review_link||"https://www.google.com";return n.NextResponse.redirect(a,{status:302})}catch(e){return console.error("Error processing click tracking:",e),new n.NextResponse("An error occurred processing your request",{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/track-click/route",pathname:"/api/track-click",filename:"route",bundlePath:"app/api/track-click/route"},resolvedPagePath:"/Users/ulrikdalanfjellstad/Desktop/Revlo/app/api/track-click/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:k,headerHooks:x,staticGenerationBailout:f}=p,g="/api/track-click/route";function m(){return(0,a.patchFetch)({serverHooks:k,staticGenerationAsyncStorage:d})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,5665,2791],()=>t(69766));module.exports=o})();