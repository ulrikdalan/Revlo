(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[585],{48991:function(e,r,n){Promise.resolve().then(n.bind(n,11154))},18087:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return l}});var t=n(57437),a=n(8792),s=n(47907),i=n(1657);function l(){let e=(0,s.usePathname)();return(0,t.jsxs)("div",{className:"bg-white rounded shadow p-4 mb-6",children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)(a.default,{href:"/dashboard",className:"text-blue-600 hover:underline",children:"← Tilbake til dashboard"})}),(0,t.jsx)("div",{className:"flex space-x-4 border-b border-gray-200",children:[{name:"Admin Dashboard",href:"/dashboard/admin"},{name:"Eksterne anmeldelser",href:"/dashboard/admin/reviews"},{name:"Review Platforms",href:"/dashboard/admin/external-platforms"}].map(r=>(0,t.jsx)(a.default,{href:r.href,className:(0,i.cn)("px-3 py-2 text-sm font-medium border-b-2 -mb-px transition-colors",e===r.href?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:r.name},r.href))})]})}},11154:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return o}});var t=n(57437),a=n(27815),s=n(18087),i=n(40386),l=n(8792);function o(){return(0,t.jsx)(i.Z,{children:(0,t.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(s.default,{}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Review Platforms Documentation"}),(0,t.jsx)(l.default,{href:"/dashboard/admin/external-platforms",className:"text-blue-600 hover:underline",children:"← Back to Platforms"})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(a.Zb,{children:[(0,t.jsx)(a.Ol,{children:(0,t.jsx)(a.ll,{children:"Overview"})}),(0,t.jsxs)(a.aY,{className:"prose max-w-none",children:[(0,t.jsx)("p",{children:"The platforms feature allows you to define and manage all external review platforms that your system integrates with. This includes customizing their display appearance in the user interface."}),(0,t.jsx)("p",{children:"Each platform record includes:"}),(0,t.jsxs)("ul",{children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"name"}),': A unique identifier for the platform (lowercase, e.g., "google")']}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"display_name"}),": The human-readable name shown in the UI"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"icon"}),": A text abbreviation used in avatars (1-2 characters)"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"color"}),": A hex color code for platform branding"]})]})]})]}),(0,t.jsxs)(a.Zb,{children:[(0,t.jsx)(a.Ol,{children:(0,t.jsx)(a.ll,{children:"Technical Implementation"})}),(0,t.jsxs)(a.aY,{className:"prose max-w-none",children:[(0,t.jsx)("h3",{children:"Database"}),(0,t.jsxs)("p",{children:["The platforms are stored in the ",(0,t.jsx)("code",{children:"platforms"})," table in Supabase with the following schema:"]}),(0,t.jsx)("pre",{className:"bg-gray-100 p-3 rounded text-sm overflow-x-auto",children:"CREATE TABLE platforms (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  name TEXT NOT NULL UNIQUE,\n  display_name TEXT NOT NULL,\n  icon TEXT,\n  color TEXT,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);"}),(0,t.jsx)("h3",{children:"Integration"}),(0,t.jsx)("p",{children:"The platforms table is used in:"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"External reviews dashboard to display platform-specific styling"}),(0,t.jsx)("li",{children:"Admin dashboard for platform management"}),(0,t.jsx)("li",{children:"Recent reviews component on the main dashboard"})]}),(0,t.jsx)("h3",{children:"Migration"}),(0,t.jsxs)("p",{children:["To set up the platforms table, visit ",(0,t.jsx)(l.default,{href:"/api/platform-migration",className:"text-blue-600 hover:underline",target:"_blank",children:"/api/platform-migration"}),". This endpoint will:"]}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Create the platforms table if it doesn't exist"}),(0,t.jsx)("li",{children:"Insert default platform records for Google, Trustpilot, Facebook, and Yelp"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Note: Only administrators can run this migration."})]})]}),(0,t.jsxs)(a.Zb,{children:[(0,t.jsx)(a.Ol,{children:(0,t.jsx)(a.ll,{children:"Usage Examples"})}),(0,t.jsxs)(a.aY,{className:"prose max-w-none",children:[(0,t.jsx)("h3",{children:"Adding a new platform"}),(0,t.jsx)("p",{children:"To add a new platform (e.g., Tripadvisor):"}),(0,t.jsxs)("ol",{children:[(0,t.jsxs)("li",{children:["Go to the ",(0,t.jsx)(l.default,{href:"/dashboard/admin/external-platforms",className:"text-blue-600 hover:underline",children:"Platforms Admin page"})]}),(0,t.jsxs)("li",{children:["Fill in the form with:",(0,t.jsxs)("ul",{children:[(0,t.jsxs)("li",{children:["Platform Code: ",(0,t.jsx)("code",{children:"tripadvisor"})]}),(0,t.jsxs)("li",{children:["Display Name: ",(0,t.jsx)("code",{children:"Tripadvisor"})]}),(0,t.jsxs)("li",{children:["Icon: ",(0,t.jsx)("code",{children:"TA"})]}),(0,t.jsxs)("li",{children:["Color: ",(0,t.jsx)("code",{children:"#34E0A1"})]})]})]}),(0,t.jsx)("li",{children:'Click "Add Platform"'})]}),(0,t.jsx)("h3",{children:"Using platform info in code"}),(0,t.jsx)("p",{children:"The platform information can be used in your components like this:"}),(0,t.jsx)("pre",{className:"bg-gray-100 p-3 rounded text-sm overflow-x-auto",children:"// Fetch platforms from Supabase\nconst { data: platforms } = await supabase.from('platforms').select('*');\n\n// Find a specific platform's info\nconst platform = platforms.find(p => p.name === 'google');\n\n// Use the platform info in UI\n<Avatar style={{ backgroundColor: platform.color }}>\n  <AvatarFallback>{platform.icon}</AvatarFallback>\n</Avatar>"})]})]})]})]})})})}},40386:function(e,r,n){"use strict";n.d(r,{Z:function(){return l}});var t=n(57437),a=n(2265),s=n(47907),i=n(45331);function l(e){let{children:r}=e,{session:n,isLoading:l}=(0,i.useAuth)(),o=(0,s.useRouter)();return((0,a.useEffect)(()=>{l||n||o.push("/login")},[l,n,o]),l)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen pointer-events-none",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n?(0,t.jsx)(t.Fragment,{children:r}):null}},27815:function(e,r,n){"use strict";n.d(r,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return o}});var t=n(57437),a=n(2265),s=n(1657);let i=a.forwardRef((e,r)=>{let{className:n,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm relative pointer-events-auto",n),...a})});i.displayName="Card";let l=a.forwardRef((e,r)=>{let{className:n,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6 pointer-events-auto",n),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,r)=>{let{className:n,...a}=e;return(0,t.jsx)("h3",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",n),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,r)=>{let{className:n,...a}=e;return(0,t.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-gray-500",n),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,r)=>{let{className:n,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0 pointer-events-auto",n),...a})});c.displayName="CardContent",a.forwardRef((e,r)=>{let{className:n,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0 pointer-events-auto",n),...a})}).displayName="CardFooter"},45331:function(e,r,n){"use strict";n.r(r),n.d(r,{AuthProvider:function(){return c},useAuth:function(){return d}});var t=n(57437),a=n(2265),s=n(47907),i=n(58714);async function l(e,r){if(!r)return!1;try{let{data:t,error:a}=await e.from("profiles").select("id").eq("id",r.id).single();if(a){if("PGRST116"!==a.code)return console.error("ensureUserProfile: Feil ved henting av profil:",a),!1;{var n;console.log("ensureUserProfile: Oppretter profil for bruker ".concat(r.id));let{error:t}=await e.from("profiles").upsert({id:r.id,email:r.email,full_name:(null===(n=r.user_metadata)||void 0===n?void 0:n.full_name)||"",onboarding_completed:!1,connected_review_platforms:[]},{onConflict:"id"});if(t)return console.error("ensureUserProfile: Feil ved oppretting av profil:",t),!1}}return!0}catch(e){return console.error("ensureUserProfile: Uventet feil:",e),!1}}let o=(0,a.createContext)({session:null,isLoading:!0,signOut:async()=>{}}),d=()=>(0,a.useContext)(o),c=e=>{let{children:r}=e,[n,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),h=(0,s.useRouter)(),f=(0,i.createClientComponentClient)();(0,a.useEffect)(()=>{(async()=>{try{let{data:{session:e}}=await f.auth.getSession();d(e),e&&await l(f,e.user)}catch(e){console.error("Error fetching session:",e)}finally{u(!1)}})();let{data:{subscription:e}}=f.auth.onAuthStateChange(async(e,r)=>{d(r),r&&await l(f,r.user)});return()=>{e.unsubscribe()}},[f.auth]);let m=async()=>{try{await f.auth.signOut(),h.push("/login")}catch(e){console.error("Error signing out:",e)}};return(0,t.jsx)(o.Provider,{value:{session:n,isLoading:c,signOut:m},children:r})}},1657:function(e,r,n){"use strict";n.d(r,{cn:function(){return s}});var t=n(75504),a=n(51367);function s(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0,a.m6)((0,t.W)(r))}},47907:function(e,r,n){"use strict";var t=n(15313);n.o(t,"usePathname")&&n.d(r,{usePathname:function(){return t.usePathname}}),n.o(t,"useRouter")&&n.d(r,{useRouter:function(){return t.useRouter}}),n.o(t,"useSearchParams")&&n.d(r,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[714,792,150,971,69,744],function(){return e(e.s=48991)}),_N_E=e.O()}]);