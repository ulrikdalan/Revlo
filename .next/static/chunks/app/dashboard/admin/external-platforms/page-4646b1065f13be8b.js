(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{89918:function(e,r,t){Promise.resolve().then(t.bind(t,2909))},18087:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return i}});var n=t(57437),a=t(8792),l=t(47907),s=t(1657);function i(){let e=(0,l.usePathname)();return(0,n.jsxs)("div",{className:"bg-white rounded shadow p-4 mb-6",children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)(a.default,{href:"/dashboard",className:"text-blue-600 hover:underline",children:"← Tilbake til dashboard"})}),(0,n.jsx)("div",{className:"flex space-x-4 border-b border-gray-200",children:[{name:"Admin Dashboard",href:"/dashboard/admin"},{name:"Eksterne anmeldelser",href:"/dashboard/admin/reviews"},{name:"Review Platforms",href:"/dashboard/admin/external-platforms"}].map(r=>(0,n.jsx)(a.default,{href:r.href,className:(0,s.cn)("px-3 py-2 text-sm font-medium border-b-2 -mb-px transition-colors",e===r.href?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:r.name},r.href))})]})}},2909:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return m}});var n=t(57437),a=t(2265),l=t(58714),s=t(27815),i=t(85754),o=t(45179),d=t(49842),c=t(18087),u=t(40386),f=t(8792);function m(){let[e,r]=(0,a.useState)([]),[t,m]=(0,a.useState)(!0),[h,p]=(0,a.useState)(null),[x,v]=(0,a.useState)(!1),[g,b]=(0,a.useState)({name:"",display_name:"",icon:"",color:"#3b82f6"}),[y,j]=(0,a.useState)(!1),N=(0,l.createClientComponentClient)();(0,a.useEffect)(()=>{async function e(){try{let{data:{session:e}}=await N.auth.getSession();if(!e)return!1;let{data:r,error:t}=await N.from("profiles").select("is_admin").eq("id",e.user.id).single();if(t)throw t;return(null==r?void 0:r.is_admin)||!1}catch(e){return console.error("Error checking admin status:",e),!1}}!async function(){m(!0);try{let t=await e();if(v(t),!t){p("You do not have permission to access this page"),m(!1);return}let{data:n,error:a}=await N.from("platforms").select("*").order("name");if(a)throw a;r(n||[])}catch(e){console.error("Error loading platforms:",e),p(e.message||"An error occurred while loading platforms")}finally{m(!1)}}()},[N]);let w=async t=>{t.preventDefault(),j(!0);try{let{data:t,error:n}=await N.from("platforms").insert({name:g.name.toLowerCase(),display_name:g.display_name,icon:g.icon,color:g.color}).select();if(n)throw n;r([...e,t[0]]),b({name:"",display_name:"",icon:"",color:"#3b82f6"})}catch(e){console.error("Error adding platform:",e),p(e.message||"An error occurred while adding the platform")}finally{j(!1)}},C=async t=>{if(confirm("Are you sure you want to delete this platform?"))try{let{error:n}=await N.from("platforms").delete().eq("id",t);if(n)throw n;r(e.filter(e=>e.id!==t))}catch(e){console.error("Error deleting platform:",e),p(e.message||"An error occurred while deleting the platform")}};return x||t?(0,n.jsx)(u.Z,{children:(0,n.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,n.jsx)(c.default,{}),(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Manage External Review Platforms"}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsxs)(f.default,{href:"/dashboard/admin/external-platforms/docs",className:"text-blue-600 hover:underline flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),"Documentation"]}),(0,n.jsxs)(f.default,{href:"/api/platform-migration",target:"_blank",className:"text-green-600 hover:underline flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),"Run Migration"]})]})]}),h&&(0,n.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:h}),t?(0,n.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,n.jsx)("div",{className:"md:col-span-2",children:(0,n.jsxs)(s.Zb,{children:[(0,n.jsx)(s.Ol,{children:(0,n.jsx)(s.ll,{children:"Platforms"})}),(0,n.jsx)(s.aY,{children:0===e.length?(0,n.jsx)("p",{className:"text-gray-500",children:"No platforms defined yet."}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"border-b",children:[(0,n.jsx)("th",{className:"px-4 py-2 text-left",children:"Name"}),(0,n.jsx)("th",{className:"px-4 py-2 text-left",children:"Display Name"}),(0,n.jsx)("th",{className:"px-4 py-2 text-left",children:"Color"}),(0,n.jsx)("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),(0,n.jsx)("tbody",{children:e.map(e=>(0,n.jsxs)("tr",{className:"border-b",children:[(0,n.jsx)("td",{className:"px-4 py-2",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-2 text-sm",style:{backgroundColor:e.color||"#e5e7eb",color:"white"},children:e.icon||e.name.substring(0,1).toUpperCase()}),e.name]})}),(0,n.jsx)("td",{className:"px-4 py-2",children:e.display_name}),(0,n.jsx)("td",{className:"px-4 py-2",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-4 h-4 rounded mr-2",style:{backgroundColor:e.color||"#e5e7eb"}}),e.color||"Not set"]})}),(0,n.jsx)("td",{className:"px-4 py-2",children:(0,n.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>C(e.id),children:"Delete"})})]},e.id))})]})})})]})}),(0,n.jsx)("div",{children:(0,n.jsxs)(s.Zb,{children:[(0,n.jsx)(s.Ol,{children:(0,n.jsx)(s.ll,{children:"Add Platform"})}),(0,n.jsx)(s.aY,{children:(0,n.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(d._,{htmlFor:"name",children:"Platform Code"}),(0,n.jsx)(o.I,{id:"name",value:g.name,onChange:e=>b({...g,name:e.target.value}),placeholder:"google",required:!0}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"Lowercase, no spaces (e.g., google, trustpilot)"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(d._,{htmlFor:"display_name",children:"Display Name"}),(0,n.jsx)(o.I,{id:"display_name",value:g.display_name,onChange:e=>b({...g,display_name:e.target.value}),placeholder:"Google",required:!0})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(d._,{htmlFor:"icon",children:"Icon (optional)"}),(0,n.jsx)(o.I,{id:"icon",value:g.icon,onChange:e=>b({...g,icon:e.target.value}),placeholder:"G"}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"Short text (1-2 characters) for icon display"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(d._,{htmlFor:"color",children:"Color"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(o.I,{id:"color",type:"color",value:g.color,onChange:e=>b({...g,color:e.target.value}),className:"w-16 h-10"}),(0,n.jsx)(o.I,{type:"text",value:g.color,onChange:e=>b({...g,color:e.target.value}),placeholder:"#3b82f6",className:"flex-1"})]})]}),(0,n.jsx)(i.z,{type:"submit",className:"w-full",disabled:y,children:y?"Adding...":"Add Platform"})]})})]})})]})]})})}):(0,n.jsx)(u.Z,{children:(0,n.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,n.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:"You do not have permission to access this page"})})})})}},40386:function(e,r,t){"use strict";t.d(r,{Z:function(){return i}});var n=t(57437),a=t(2265),l=t(47907),s=t(45331);function i(e){let{children:r}=e,{session:t,isLoading:i}=(0,s.useAuth)(),o=(0,l.useRouter)();return((0,a.useEffect)(()=>{i||t||o.push("/login")},[i,t,o]),i)?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen pointer-events-none",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):t?(0,n.jsx)(n.Fragment,{children:r}):null}},85754:function(e,r,t){"use strict";t.d(r,{z:function(){return d}});var n=t(57437),a=t(2265),l=t(59143),s=t(49769),i=t(1657);let o=(0,s.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 relative",{variants:{variant:{default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-blue-600 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,r)=>{let{className:t,variant:a,size:s,asChild:d=!1,disabled:c,...u}=e,f=d?l.g7:"button";return(0,n.jsx)(f,{className:(0,i.cn)(o({variant:a,size:s,className:t}),c?"pointer-events-none":"pointer-events-auto"),ref:r,disabled:c,...u})});d.displayName="Button"},27815:function(e,r,t){"use strict";t.d(r,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return s},aY:function(){return c},ll:function(){return o}});var n=t(57437),a=t(2265),l=t(1657);let s=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,l.cn)("rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm relative pointer-events-auto",t),...a})});s.displayName="Card";let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,l.cn)("flex flex-col space-y-1.5 p-6 pointer-events-auto",t),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("h3",{ref:r,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("p",{ref:r,className:(0,l.cn)("text-sm text-gray-500",t),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,l.cn)("p-6 pt-0 pointer-events-auto",t),...a})});c.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,l.cn)("flex items-center p-6 pt-0 pointer-events-auto",t),...a})}).displayName="CardFooter"},45179:function(e,r,t){"use strict";t.d(r,{I:function(){return s}});var n=t(57437),a=t(2265),l=t(1657);let s=a.forwardRef((e,r)=>{let{className:t,type:a,...s}=e;return(0,n.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s})});s.displayName="Input"},49842:function(e,r,t){"use strict";t.d(r,{_:function(){return d}});var n=t(57437),a=t(2265),l=t(24602),s=t(49769),i=t(1657);let o=(0,s.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(l.f,{ref:r,className:(0,i.cn)(o(),t),...a})});d.displayName=l.f.displayName},45331:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return c},useAuth:function(){return d}});var n=t(57437),a=t(2265),l=t(47907),s=t(58714);async function i(e,r){if(!r)return!1;try{let{data:n,error:a}=await e.from("profiles").select("id").eq("id",r.id).single();if(a){if("PGRST116"!==a.code)return console.error("ensureUserProfile: Feil ved henting av profil:",a),!1;{var t;console.log("ensureUserProfile: Oppretter profil for bruker ".concat(r.id));let{error:n}=await e.from("profiles").upsert({id:r.id,email:r.email,full_name:(null===(t=r.user_metadata)||void 0===t?void 0:t.full_name)||"",onboarding_completed:!1,connected_review_platforms:[]},{onConflict:"id"});if(n)return console.error("ensureUserProfile: Feil ved oppretting av profil:",n),!1}}return!0}catch(e){return console.error("ensureUserProfile: Uventet feil:",e),!1}}let o=(0,a.createContext)({session:null,isLoading:!0,signOut:async()=>{}}),d=()=>(0,a.useContext)(o),c=e=>{let{children:r}=e,[t,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),f=(0,l.useRouter)(),m=(0,s.createClientComponentClient)();(0,a.useEffect)(()=>{(async()=>{try{let{data:{session:e}}=await m.auth.getSession();d(e),e&&await i(m,e.user)}catch(e){console.error("Error fetching session:",e)}finally{u(!1)}})();let{data:{subscription:e}}=m.auth.onAuthStateChange(async(e,r)=>{d(r),r&&await i(m,r.user)});return()=>{e.unsubscribe()}},[m.auth]);let h=async()=>{try{await m.auth.signOut(),f.push("/login")}catch(e){console.error("Error signing out:",e)}};return(0,n.jsx)(o.Provider,{value:{session:t,isLoading:c,signOut:h},children:r})}},1657:function(e,r,t){"use strict";t.d(r,{cn:function(){return l}});var n=t(75504),a=t(51367);function l(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,n.W)(r))}},47907:function(e,r,t){"use strict";var n=t(15313);t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(r,{useSearchParams:function(){return n.useSearchParams}})},61266:function(e,r,t){"use strict";t.d(r,{F:function(){return l},e:function(){return s}});var n=t(2265);function a(e,r){if("function"==typeof e)return e(r);null!=e&&(e.current=r)}function l(...e){return r=>{let t=!1,n=e.map(e=>{let n=a(e,r);return t||"function"!=typeof n||(t=!0),n});if(t)return()=>{for(let r=0;r<n.length;r++){let t=n[r];"function"==typeof t?t():a(e[r],null)}}}}function s(...e){return n.useCallback(l(...e),e)}},24602:function(e,r,t){"use strict";t.d(r,{f:function(){return i}});var n=t(2265),a=t(29586),l=t(57437),s=n.forwardRef((e,r)=>(0,l.jsx)(a.WV.label,{...e,ref:r,onMouseDown:r=>{var t;r.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));s.displayName="Label";var i=s},29586:function(e,r,t){"use strict";t.d(r,{WV:function(){return i},jH:function(){return o}});var n=t(2265),a=t(54887),l=t(59143),s=t(57437),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let t=(0,l.Z8)(`Primitive.${r}`),a=n.forwardRef((e,n)=>{let{asChild:a,...l}=e,i=a?t:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(i,{...l,ref:n})});return a.displayName=`Primitive.${r}`,{...e,[r]:a}},{});function o(e,r){e&&a.flushSync(()=>e.dispatchEvent(r))}},59143:function(e,r,t){"use strict";t.d(r,{Z8:function(){return s},g7:function(){return i}});var n=t(2265),a=t(61266),l=t(57437);function s(e){let r=function(e){let r=n.forwardRef((e,r)=>{let{children:t,...l}=e;if(n.isValidElement(t)){let e,s;let i=(e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.props.ref:t.props.ref||t.ref,o=function(e,r){let t={...r};for(let n in r){let a=e[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?t[n]=(...e)=>{l(...e),a(...e)}:a&&(t[n]=a):"style"===n?t[n]={...a,...l}:"className"===n&&(t[n]=[a,l].filter(Boolean).join(" "))}return{...e,...t}}(l,t.props);return t.type!==n.Fragment&&(o.ref=r?(0,a.F)(r,i):i),n.cloneElement(t,o)}return n.Children.count(t)>1?n.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}(e),t=n.forwardRef((e,t)=>{let{children:a,...s}=e,i=n.Children.toArray(a),o=i.find(d);if(o){let e=o.props.children,a=i.map(r=>r!==o?r:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,l.jsx)(r,{...s,ref:t,children:n.isValidElement(e)?n.cloneElement(e,void 0,a):null})}return(0,l.jsx)(r,{...s,ref:t,children:a})});return t.displayName=`${e}.Slot`,t}var i=s("Slot"),o=Symbol("radix.slottable");function d(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},49769:function(e,r,t){"use strict";t.d(r,{j:function(){return s}});var n=t(75504);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,l=n.W,s=(e,r)=>t=>{var n;if((null==r?void 0:r.variants)==null)return l(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:s,defaultVariants:i}=r,o=Object.keys(s).map(e=>{let r=null==t?void 0:t[e],n=null==i?void 0:i[e];if(null===r)return null;let l=a(r)||a(n);return s[e][l]}),d=t&&Object.entries(t).reduce((e,r)=>{let[t,n]=r;return void 0===n||(e[t]=n),e},{});return l(e,o,null==r?void 0:null===(n=r.compoundVariants)||void 0===n?void 0:n.reduce((e,r)=>{let{class:t,className:n,...a}=r;return Object.entries(a).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...i,...d}[r]):({...i,...d})[r]===t})?[...e,t,n]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)}}},function(e){e.O(0,[714,792,150,971,69,744],function(){return e(e.s=89918)}),_N_E=e.O()}]);