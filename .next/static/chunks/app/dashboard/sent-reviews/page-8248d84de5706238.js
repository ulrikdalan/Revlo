(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{62104:function(e,s,t){Promise.resolve().then(t.bind(t,3820))},3820:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var n=t(57437),a=t(2265),r=t(8792),l=t(49231),i=t(58714);function c(){let[e,s]=(0,a.useState)(""),[t,r]=(0,a.useState)(""),[l,i]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[o,x]=(0,a.useState)(!1),p=async n=>{n.preventDefault(),d(!0),(await fetch("/api/send-review-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,reviewLink:l})})).ok?(x(!0),s(""),r(""),i("")):alert("Feil ved sending av e-post"),d(!1)};return(0,n.jsxs)("form",{onSubmit:p,className:"space-y-4 max-w-md mx-auto",children:[(0,n.jsx)("input",{type:"text",placeholder:"Navn",value:e,onChange:e=>s(e.target.value),className:"border px-4 py-2 w-full"}),(0,n.jsx)("input",{type:"email",placeholder:"E-post",value:t,onChange:e=>r(e.target.value),className:"border px-4 py-2 w-full"}),(0,n.jsx)("input",{type:"text",placeholder:"Review-link",value:l,onChange:e=>i(e.target.value),className:"border px-4 py-2 w-full"}),(0,n.jsx)("button",{type:"submit",disabled:c,className:"bg-blue-600 text-white px-4 py-2 rounded",children:c?"Sender...":"Send vurderingsforesp\xf8rsel"}),o&&(0,n.jsx)("p",{className:"text-green-600",children:"E-post sendt!"})]})}function d(e){return e?(0,l.WU)(new Date(e),"dd.MM.yyyy HH:mm"):""}function o(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)(!0),[o,x]=(0,a.useState)(null),[p,m]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),g=async()=>{l(!0),x(null);try{let e=(0,i.createClientComponentClient)(),{data:{session:t}}=await e.auth.getSession();if(!t){m(!1),l(!1);return}m(!0);let n=await fetch("/api/get-sent-emails",{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw Error("Kunne ikke hente e-poster");let a=await n.json();s(a.emails||[])}catch(e){console.error("Error fetching sent emails:",e),x(e.message||"Feil ved henting av e-poster")}finally{l(!1)}};return((0,a.useEffect)(()=>{g()},[]),p)?(0,n.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,n.jsxs)("div",{className:"max-w-6xl mx-auto bg-white rounded shadow p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Sendte vurderingsforesp\xf8rsler"}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)("button",{onClick:()=>{h(!u)},className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors flex items-center",children:u?"Skjul skjema":"Ny foresp\xf8rsel"}),(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),g()},children:(0,n.jsxs)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Oppdater"]})})]})]}),u&&(0,n.jsxs)("div",{className:"mb-8 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Send ny vurderingsforesp\xf8rsel"}),(0,n.jsx)(c,{})]}),t&&(0,n.jsxs)("div",{className:"bg-gray-100 p-4 rounded text-gray-700 flex items-center justify-center",children:[(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Laster inn..."]}),o&&(0,n.jsxs)("div",{className:"bg-red-100 text-red-700 p-4 rounded mb-6",children:["Feil ved henting av data: ",o]}),t||0!==e.length?(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Navn"}),(0,n.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"E-post"}),(0,n.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,n.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sendt"}),(0,n.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"P\xe5minnelse sendt"}),(0,n.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Klikket"}),(0,n.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("SENT"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.status})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d(e.sent_at)}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.reminder_sent_at?(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-2 w-2 h-2 bg-blue-500 rounded-full"}),d(e.reminder_sent_at)]}):(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-2 w-2 h-2 bg-gray-300 rounded-full"}),"Ikke sendt"]})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.clicked_at?(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-2 w-2 h-2 bg-green-500 rounded-full"}),d(e.clicked_at)]}):(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-2 w-2 h-2 bg-gray-300 rounded-full"}),"Ikke klikket"]})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-500",children:(0,n.jsx)("a",{href:e.review_link,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"\xc5pne"})})]},e.id))})]})}):(0,n.jsx)("div",{className:"bg-blue-50 p-4 rounded text-blue-800",children:"Ingen e-poster er sendt enn\xe5."})]})}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,n.jsx)("div",{className:"max-w-6xl mx-auto bg-white rounded shadow p-6",children:(0,n.jsxs)("div",{className:"bg-red-100 p-4 rounded mb-6",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Ikke innlogget"}),(0,n.jsx)("p",{className:"mb-4",children:"Du m\xe5 v\xe6re logget inn for \xe5 se denne siden."}),(0,n.jsx)(r.default,{href:"/login",className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"G\xe5 til innloggingssiden"})]})})})}}},function(e){e.O(0,[714,792,231,971,69,744],function(){return e(e.s=62104)}),_N_E=e.O()}]);