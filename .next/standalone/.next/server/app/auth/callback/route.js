"use strict";(()=>{var e={};e.id=7936,e.ids=[7936],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},98381:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>b});var o={};t.r(o),t.d(o,{GET:()=>c});var n=t(95419),a=t(69108),i=t(99678),l=t(98984),s=t(57699),u=t(7439);async function c(e){let r=new URL(e.url),t=r.searchParams.get("code"),o=r.searchParams.get("error"),n=r.searchParams.get("error_description"),a=r.searchParams.get("type");if(o)return console.error("Auth callback error:",n),l.NextResponse.redirect(new URL(`/login?error=${encodeURIComponent(n||"En feil oppstod")}`,e.url));if(t){let r=(0,s.createRouteHandlerClient)({cookies:u.cookies});await r.auth.exchangeCodeForSession(t);let{data:{user:o}}=await r.auth.getUser();if(o){console.log("Auth callback - Bruker autentisert:",o.id);let{data:e,error:t}=await r.from("profiles").select("id, onboarding_completed").eq("id",o.id).single();if(t||!e){console.log("Auth callback - Ingen profil funnet, oppretter ny profil for bruker:",o.id);let{error:e}=await r.from("profiles").insert({id:o.id,email:o.email,full_name:o.user_metadata?.full_name||"",onboarding_completed:!1,connected_review_platforms:[]});e?console.error("Auth callback - Feil ved oppretting av brukerprofil:",e):console.log("Auth callback - Brukerprofil opprettet vellykket")}else console.log("Auth callback - Brukerprofil funnet. Onboarding status:",e.onboarding_completed)}if("recovery"===a)return l.NextResponse.redirect(new URL("/update-password",e.url));if("signup"===a){let{data:{session:t}}=await r.auth.getSession();if(t?.user){let{data:o}=await r.from("profiles").select("onboarding_completed").eq("id",t.user.id).single();if(!o?.onboarding_completed)return console.log("Auth callback - Verifisert bruker, men onboarding ikke fullf\xf8rt, omdirigerer til login"),l.NextResponse.redirect(new URL("/login?verified=true",e.url));console.log("Auth callback - Verifisert bruker med fullf\xf8rt onboarding, omdirigerer til dashboard")}}}return l.NextResponse.redirect(new URL("/dashboard",e.url))}let d=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/auth/callback/route",pathname:"/auth/callback",filename:"route",bundlePath:"app/auth/callback/route"},resolvedPagePath:"/Users/ulrikdalanfjellstad/Desktop/Revlo/app/auth/callback/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:f,serverHooks:g,headerHooks:m,staticGenerationBailout:b}=d,h="/auth/callback/route";function y(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},48096:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{DynamicServerError:function(){return o},isDynamicServerError:function(){return n}});let t="DYNAMIC_SERVER_USAGE";class o extends Error{constructor(e){super("Dynamic server usage: "+e),this.description=e,this.digest=t}}function n(e){return"object"==typeof e&&null!==e&&"digest"in e&&"string"==typeof e.digest&&e.digest===t}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},72973:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{isStaticGenBailoutError:function(){return l},staticGenerationBailout:function(){return u}});let o=t(48096),n=t(45869),a="NEXT_STATIC_GEN_BAILOUT";class i extends Error{constructor(...e){super(...e),this.code=a}}function l(e){return"object"==typeof e&&null!==e&&"code"in e&&e.code===a}function s(e,r){let{dynamic:t,link:o}=r||{};return"Page"+(t?' with `dynamic = "'+t+'"`':"")+" couldn't be rendered statically because it used `"+e+"`."+(o?" See more info here: "+o:"")}let u=(e,r)=>{let{dynamic:t,link:a}=void 0===r?{}:r,l=n.staticGenerationAsyncStorage.getStore();if(!l)return!1;if(l.forceStatic)return!0;if(l.dynamicShouldError)throw new i(s(e,{link:a,dynamic:null!=t?t:"error"}));let u=s(e,{dynamic:t,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if(null==l.postpone||l.postpone.call(l,e),l.revalidate=0,l.isStaticGeneration){let r=new o.DynamicServerError(u);throw l.dynamicUsageDescription=e,l.dynamicUsageStack=r.stack,r}return!1};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,5665,2791,3421],()=>t(98381));module.exports=o})();